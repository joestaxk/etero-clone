!function(e,t,n){var r={production:"https://etorologsapi.etoro.com/api/v2/monitoring?applicationIdentifier=",staging:"http://etoro-logs-api-staging.cloudapp.net/api/v2/monitoring?applicationIdentifier="},o=["info","error","warn","debug"],a=["LP","innerPages","HomePage","registrationFrom","RAF"],s="etoroMarketingUserSession";function u(){return"xxxxtxxx-xxxx-4xxx-yxxx-xxxxxxtxxxxx".replace(/t/g,function(e){return((new Date).getTime()%16).toString(16)}).replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})}function c(e,t){for(var n in t)e[n]=t[n];return e}function g(){if(!localStorage)return null;try{var e=localStorage.getItem(s);return e||localStorage.setItem(s,u()),e=localStorage.getItem(s)}catch(e){return null}}function l(e){var t=e.prototype.SessionGuid;return t||u()}var f=[];function p(t){t.debugMsg("Info: catchJSErrors");e.onerror=function(n,r,o,a){a=a||e.event&&e.event.errorCharacter;var s=[];try{for(var u=arguments.callee.caller;u;)s.push(u.name),u=u.caller}catch(e){}try{!function(e,t){var n=!1;for(i=0;i<f.length;i++)f[i].msg==e&&(n=!0,f[i].count++);n||f.push({msg:e,count:1}),setTimeout(function(){var e=[];if(0!=f.length){for(i=0;i<f.length;i++)e.push({Level:"error",Message:"JS error/exception",errorMessage:f[i].msg,errorMessageCount:f[i].count});t.send(e),f=[]}},2e3)}(n+"from"+JSON.stringify(s),t)}catch(e){t.debugMsg("Faild to parse JS error ",e)}return!1}}var d,h=function(t,n,o,i,s,u){var f,p=this;p.config={ApplicationIdentifier:"marketingSites",ApplicationVersion:n,AppName:t,Categories:a.indexOf(o)>-1?o:"marketingUnknown",SessionGuid:l(h),UserSessionGuid:g(),Location:location.href,Message:null,DOMLoadTime:function(){var t=null;try{t=(t=e.performance.timing.domContentLoadedEventEnd-e.performance.timing.navigationStart)>0&&t<1e5?t:null}catch(e){}return t}(),Level:"info"},c(this.config,i),p.debug=s,p.environment=(f=r[u]?u:"production",p.debugMsg("environment: "+f),f),p.init()};h.prototype.debugMsg=function(){this.debug&&Function.prototype.bind.call(console.warn,console).apply(this,arguments)},h.prototype.createEvent=function(t){if(!t.Level||!t.Message)return this.debugMsg("Missing 'Level' or 'Message'"),null;var n=function e(t){if("[object Array]"===Object.prototype.toString.call(t)){for(var n=[],r=0;r<t.length;r++)n[r]=e(t[r]);return n}if("object"==typeof t){for(var o in n={},t)t.hasOwnProperty(o)&&(n[o]=e(t[o]));return n}return t}(this.config);return c(n,t),n.Level=o.indexOf(n.Level)>-1?n.Level:"info",n.DomComplete=function(){var t=null;try{t=(t=e.performance.timing.domComplete-e.performance.timing.navigationStart)>0&&t<1e5?t:null}catch(e){t=e.message}return t}(),n.ClientDateTime=(new Date).toISOString().split(".")[0]+"Z",n},h.prototype.send=function(e){var t=this;if(e&&e.length&&"object"==typeof e){var n=[];for(k=0;k<e.length;k++){var r=t.createEvent(e[k]);r&&n.push(r)}if(0!=n.length){try{objToUrlParm=encodeURIComponent(JSON.stringify(n))}catch(e){return}fullUrlGetMethod=t.logUrl+"&LogEvents="+objToUrlParm,this.http("POST",t.logUrl,{},"",null,JSON.stringify({LogEvents:n}),function(e,n){e||(t.debugMsg("Faild to send the event as POST request"),function(e,t){e.debugMsg("Sending event as image");var n=document.createElement("img"),r=u();n.setAttribute("id",r),n.setAttribute("src",t),n.setAttribute("height","1"),n.setAttribute("width","1"),n.style.display="none",document.body.appendChild(n),setTimeout(function(){var e=document.getElementById(r);e&&(e.outerHTML="",delete e)},100)}(t,fullUrlGetMethod))})}else t.debugMsg("no events was passed")}else t.debugMsg("The argument have to be Array with objects")},h.prototype.http=function(e,t,n,r,o,i,a){var s=this,c=t.indexOf(s.logUrl)>-1,g=new Date,l=(s=this,t);if(!c){var f=u(),p=t.indexOf("?")>-1?"&":"?";t=t+p+"client_request_id="+f}var d=function(t,n){c||function(e,t,n,r,o,i,a){var s=t?"info":"error",u=null,c=new Date;o.target&&(u=o.target.status),e.debugMsg("HTTP callback ",{success:t,status:u,url:n}),e.send([{Level:s,Message:"networkLog",Performance_RequestTime:c-i,Request_Url:n,Request_Method:r,Request_Status:u,Request_Id:a}])}(s,t,l,e,n,g,f),a(t,n)},h=new XMLHttpRequest;try{h.open(e,t)}catch(e){return void d(!1,e)}"object"==typeof n&&Object.keys(n).forEach(function(e){h.setRequestHeader(e,n[e])}),"json"==r&&h.setRequestHeader("Content-Type","application/json; charset=utf-8"),o&&(h.timeout=o),h.onprogress=function(){},h.ontimeout=function(e){d(!1,e)},h.onerror=function(e){d(!1,e)},h.onreadystatechange=function(e){},h.onload=function(e){e&&e.target&&0!=e.target.status&&e.target.status<300?d(!0,e):d(!1,e)},h.send(i)},h.prototype.load=!0,h.prototype.SessionGuid=l(h),h.prototype.init=function(){this.logUrl=r[this.environment]+this.config.ApplicationIdentifier,this.debugMsg("Log mode: "+this.environment),p(this)},e.etoroLogger=h,(d=e[n])&&Object.keys(d).forEach(function(t){!function(t,r){var o=r.actionsRecorder;e[n][t]=new h;var a=e[n][t];if(h.apply(a,r.settings),o)for(i=0;i<o.length;i++){var s=o[i],u=s[0];s.shift(),a[u]&&a[u].apply(a,s)}}(t,d[t])})}(window,0,"etoroLoggerApps");